<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìÖ Crop Planner - Aeterna</title>
  <link rel="stylesheet" href="style.css">

   
</head>
<body>
    <div class="dashboard-container">
        <div class="dashboard-header">
            <div class="header-left">
                <a href="../index.html" class="back-btn">‚Üê Back to Dashboard</a>
                <h1>üìÖ Crop Planning Center</h1>
                <p>Plan, schedule, and track your farming activities</p>
            </div>
            <div class="user-profile">
                <div id="user-display-name">User</div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>

        <div class="page-content">
            <div class="planner-grid">
                <!-- Planning Form -->
                <div class="card">
                    <div class="card-header">
                        <h2>üå± New Crop Plan</h2>
                    </div>
                    <div class="planning-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="crop-type">Crop Type</label>
                                <select id="crop-type">
                                    <option value="">Select a crop</option>
                                    <option value="maize">Maize</option>
                                    <option value="wheat">Wheat</option>
                                    <option value="rice">Rice</option>
                                    <option value="beans">Beans</option>
                                    <option value="tomato">Tomato</option>
                                    <option value="potato">Potato</option>
                                    <option value="sorghum">Sorghum</option>
                                    <option value="millet">Millet</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="variety">Variety</label>
                                <input type="text" id="variety" placeholder="Crop variety">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="planting-date">Planting Date</label>
                                <input type="date" id="planting-date">
                            </div>
                            <div class="form-group">
                                <label for="area">Area (acres)</label>
                                <input type="number" id="area" value="1" min="0.1" step="0.1">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="notes">Notes & Requirements</label>
                            <textarea id="notes" rows="3" placeholder="Special requirements, soil prep notes..."></textarea>
                        </div>

                        <div class="form-actions">
                            <button onclick="plannerApp.createPlan()" class="btn-primary btn-large">
                                üìÖ Create Crop Plan
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Plan Summary -->
                <div class="card">
                    <div class="card-header">
                        <h2>üìä Plan Summary</h2>
                    </div>
                    <div id="plan-summary">
                        <div class="empty-state">
                            <div class="empty-icon">üìÖ</div>
                            <h3>No Active Plan</h3>
                            <p>Create a crop plan to see the schedule and tasks.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Current Plans -->
            <div class="card">
                <div class="card-header">
                    <h2>üåæ Active Crop Plans</h2>
                    <button onclick="plannerApp.showAllPlans()" class="btn-outline">View All Plans</button>
                </div>
                <div id="active-plans">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading your crop plans...</p>
                    </div>
                </div>
            </div>

            <!-- Calendar View -->
            <div class="calendar-view">
                <div class="card-header">
                    <h2>üìÖ Farming Calendar</h2>
                    <div class="calendar-nav">
                        <button onclick="plannerApp.previousMonth()" class="btn-outline">‚Üê Prev</button>
                        <span id="current-month" style="font-weight: 600;"></span>
                        <button onclick="plannerApp.nextMonth()" class="btn-outline">Next ‚Üí</button>
                    </div>
                </div>
                <div id="calendar-container">
                    <!-- Calendar will be generated by JavaScript -->
                </div>
            </div>

            <!-- Upcoming Tasks -->
            <div class="card">
                <div class="card-header">
                    <h2>‚úÖ Upcoming Tasks</h2>
                </div>
                <div id="upcoming-tasks">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading upcoming tasks...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="./planner.js"></script>
    <script>
        const plannerApp = new PlannerApp();
        
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                document.cookie = "user_data=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.cookie = "auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                localStorage.removeItem('user_data');
                window.location.href = '../index.html';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const userData = getCookie('user_data');
            if (userData) {
                try {
                    const user = JSON.parse(userData);
                    document.getElementById('user-display-name').textContent = user.full_name || user.username;
                } catch (e) {
                    console.error('Error parsing user data:', e);
                }
            }
            plannerApp.initialize();
        });

        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
            return null;
        }
    </script>
</body>
</html>